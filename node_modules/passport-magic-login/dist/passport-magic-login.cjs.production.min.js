"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e,n=(e=require("jsonwebtoken"))&&"object"==typeof e&&"default"in e?e.default:e;function t(){return(t=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e}).apply(this,arguments)}var o=function(e,t){return n.sign(t,e,{expiresIn:"60min"})};exports.default=function(){function e(e){var n=this;this._options=e,this.name="magiclogin",this.send=function(e,r){if(e.body.destination){var i=Math.floor(9e4*Math.random())+1e4+"",s=o(n._options.secret,t({},e.body,{code:i}));n._options.sendMagicLink(e.body.destination,n._options.callbackUrl+"?token="+s,i,e).then((function(){r.json({success:!0,code:i})})).catch((function(e){console.error(e),r.json({success:!1,error:e})}))}else r.status(400).send("Please specify the destination.")},this.confirm=function(e,t){console.warn("magicLink.confirm was removed in v1.0.7, it is no longer necessary."),t.redirect(n._options.callbackUrl+"?token="+e.query.token)}}return e.prototype.authenticate=function(e){var t=this,o=function(e,t){if("string"!=typeof t)return!1;try{return n.verify(t,e)}catch(e){return!1}}(t._options.secret,e.query.token);t._options.verify(o,(function(e,n,o){return e?t.error(e):n?t.success(n,o):t.fail(o)}))},e}();
//# sourceMappingURL=passport-magic-login.cjs.production.min.js.map
